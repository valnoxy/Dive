using Dive.Core.Common;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Management;
using Dive.UI.Common.UserInterface;

namespace Dive.UI.Common
{
    public class CPUCompatibility
    {
        private static readonly Dictionary<string, List<string>> CompatibleCpus = new Dictionary<string, List<string>>(StringComparer.OrdinalIgnoreCase)
        {
            // Intel-CPUs
            { 
                "Intel Core", [
                    "3 100HL",
                    "3 100U",
                    "3 100U",
                    "3 100UL",
                    "3 N350",
                    "3 N355",
                    "5 120HL",
                    "5 120U",
                    "5 120UL",
                    "5 130HL",
                    "5 130UL",
                    "5 210H",
                    "5 220H",
                    "7 150HL",
                    "7 150U",
                    "7 150UL",
                    "7 160HL",
                    "7 160UL",
                    "7 240H",
                    "7 250H",
                    "9 270H",
                    "i3-14100",
                    "i3-14100F",
                    "i3-14100T",
                    "i3-1005G1",
                    "i3-10100",
                    "i3-10100E",
                    "i3-10100F",
                    "i3-10100T",
                    "i3-10100TE",
                    "i3-10100Y",
                    "i3-10105",
                    "i3-10105F",
                    "i3-10105T",
                    "i3-10110U",
                    "i3-10110Y",
                    "i3-10300",
                    "i3-10300T",
                    "i3-10305",
                    "i3-10305T",
                    "i3-10320",
                    "i3-10325",
                    "i3-11100HE",
                    "i3-1110G4",
                    "i3-1115G4",
                    "i3-1115GRE",
                    "i3-1120G4",
                    "i3-1125G4",
                    "i3-12100",
                    "i3-12100E",
                    "i3-12100F",
                    "i3-12100T",
                    "i3-12100TE",
                    "i3-1210U",
                    "i3-1215U",
                    "i3-1215UE",
                    "i3-1215UL",
                    "i3-1220P",
                    "i3-1220PE",
                    "i3-12300",
                    "i3-12300HE",
                    "i3-12300HL",
                    "i3-12300T",
                    "i3-1305U",
                    "i3-13100",
                    "i3-13100E",
                    "i3-13100F",
                    "i3-13100T",
                    "i3-13100TE",
                    "i3-1315U",
                    "i3-1315UE",
                    "i3-1315URE",
                    "i3-1320PE",
                    "i3-1320PRE",
                    "i3-13300HE",
                    "i3-13300HRE",
                    "i3-8100",
                    "i3-8100B",
                    "i3-8100H",
                    "i3-8100T",
                    "i3-8109U",
                    "i3-8130U",
                    "i3-8140U",
                    "i3-8145U",
                    "i3-8145UE",
                    "i3-8300",
                    "i3-8300T",
                    "i3-8350K",
                    "i3-9100",
                    "i3-9100E",
                    "i3-9100F",
                    "i3-9100HL",
                    "i3-9100T",
                    "i3-9100TE",
                    "i3-9300",
                    "i3-9300T",
                    "i3-9320",
                    "i3-9350K",
                    "i3-9350KF",
                    "i3-N300",
                    "i3-N305",
                    "i5-14400",
                    "i5-14400F",
                    "i5-14400T",
                    "i5-14450HX",
                    "i5-14500",
                    "i5-14500HX",
                    "i5-14500T",
                    "i5-14600",
                    "i5-14600K",
                    "i5-14600KF",
                    "i5-14600T",
                    "i5-10200H",
                    "i5-10210U",
                    "i5-10210Y",
                    "i5-10300H",
                    "i5-10310U",
                    "i5-10310Y",
                    "i5-1035G1",
                    "i5-1035G4",
                    "i5-1035G7",
                    "i5-10400",
                    "i5-10400F",
                    "i5-10400H",
                    "i5-10400T",
                    "i5-10500",
                    "i5-10500E",
                    "i5-10500H",
                    "i5-10500T",
                    "i5-10500TE",
                    "i5-10505",
                    "i5-10600",
                    "i5-10600K",
                    "i5-10600KF",
                    "i5-10600T",
                    "i5-11260H",
                    "i5-11300H",
                    "i5-1130G7",
                    "i5-11320H",
                    "i5-1135G7",
                    "i5-11400",
                    "i5-11400F",
                    "i5-11400H",
                    "i5-11400T",
                    "i5-1140G7",
                    "i5-1145G7",
                    "i5-1145G7E",
                    "i5-1145GRE",
                    "i5-11500",
                    "i5-11500H",
                    "i5-11500HE",
                    "i5-11500T",
                    "i5-1155G7",
                    "i5-11600",
                    "i5-11600K",
                    "i5-11600KF",
                    "i5-11600T",
                    "i5-1230U",
                    "i5-1235U",
                    "i5-1235UL",
                    "i5-12400",
                    "i5-12400F",
                    "i5-12400T",
                    "i5-1240P",
                    "i5-1240U",
                    "i5-12450H",
                    "i5-12450HX",
                    "i5-1245U",
                    "i5-1245UE",
                    "i5-1245UL",
                    "i5-12500",
                    "i5-12500E",
                    "i5-12500H",
                    "i5-12500HL",
                    "i5-12500T",
                    "i5-12500TE",
                    "i5-1250P",
                    "i5-1250PE",
                    "i5-12600",
                    "i5-12600H",
                    "i5-12600HE",
                    "i5-12600HL",
                    "i5-12600HX",
                    "i5-12600K",
                    "i5-12600KF",
                    "i5-12600T",
                    "i5-1334U",
                    "i5-1335U",
                    "i5-1335UE",
                    "i5-13400",
                    "i5-13400E",
                    "i5-13400F",
                    "i5-13400T",
                    "i5-1340P",
                    "i5-1340PE",
                    "i5-13420H",
                    "i5-13450HX",
                    "i5-1345U",
                    "i5-1345UE",
                    "i5-1345URE",
                    "i5-13500",
                    "i5-13500E",
                    "i5-13500H",
                    "i5-13500HX",
                    "i5-13500T",
                    "i5-13500TE",
                    "i5-13505H",
                    "i5-1350P",
                    "i5-1350PE",
                    "i5-1350PRE",
                    "i5-13600",
                    "i5-13600H",
                    "i5-13600HE",
                    "i5-13600HRE",
                    "i5-13600HX",
                    "i5-13600K",
                    "i5-13600KF",
                    "i5-13600T",
                    "i5-8200Y",
                    "i5-8210Y",
                    "i5-8250U",
                    "i5-8257U",
                    "i5-8259U",
                    "i5-8260U",
                    "i5-8265U",
                    "i5-8269U",
                    "i5-8279U",
                    "i5-8300H",
                    "i5-8310Y",
                    "i5-8350U",
                    "i5-8365U",
                    "i5-8365UE",
                    "i5-8400",
                    "i5-8400B",
                    "i5-8400H",
                    "i5-8400T",
                    "i5-8500",
                    "i5-8500B",
                    "i5-8500T",
                    "i5-8600",
                    "i5-8600K",
                    "i5-8600T",
                    "i5-9300H",
                    "i5-9300HF",
                    "i5-9400",
                    "i5-9400F",
                    "i5-9400H",
                    "i5-9400T",
                    "i5-9500",
                    "i5-9500E",
                    "i5-9500F",
                    "i5-9500T",
                    "i5-9500TE",
                    "i5-9600",
                    "i5-9600K",
                    "i5-9600KF",
                    "i5-9600T",
                    "i7-14650HX",
                    "i7-14700",
                    "i7-14700F",
                    "i7-14700HX",
                    "i7-14700K",
                    "i7-14700KF",
                    "i7-14700T",
                    "i7-10510U",
                    "i7-10510Y",
                    "i7-10610U",
                    "i7-1065G7",
                    "i7-10700",
                    "i7-10700E",
                    "i7-10700F",
                    "i7-10700K",
                    "i7-10700KF",
                    "i7-10700T",
                    "i7-10700TE",
                    "i7-10710U",
                    "i7-10750H",
                    "i7-10810U",
                    "i7-10850H",
                    "i7-10870H",
                    "i7-10875H",
                    "i7-11370H",
                    "i7-11375H",
                    "i7-11390H",
                    "i7-11600H",
                    "i7-1160G7",
                    "i7-1165G7",
                    "i7-11700",
                    "i7-11700F",
                    "i7-11700K",
                    "i7-11700KF",
                    "i7-11700T",
                    "i7-11800H",
                    "i7-1180G7",
                    "i7-11850H",
                    "i7-11850HE",
                    "i7-1185G7",
                    "i7-1185G7E",
                    "i7-1185GRE",
                    "i7-1195G7",
                    "i7-1250U",
                    "i7-1255U",
                    "i7-1255UL",
                    "i7-1260P",
                    "i7-1260U",
                    "i7-12650H",
                    "i7-12650HX",
                    "i7-1265U",
                    "i7-1265UE",
                    "i7-1265UL",
                    "i7-12700",
                    "i7-12700E",
                    "i7-12700F",
                    "i7-12700H",
                    "i7-12700HL",
                    "i7-12700K",
                    "i7-12700KF",
                    "i7-12700T",
                    "i7-12700TE",
                    "i7-1270P",
                    "i7-1270PE",
                    "i7-12800H",
                    "i7-12800HE",
                    "i7-12800HL",
                    "i7-12800HX",
                    "i7-1280P",
                    "i7-12850HX",
                    "i7-1355U",
                    "i7-1360P",
                    "i7-13620H",
                    "i7-13650HX",
                    "i7-1365U",
                    "i7-1365UE",
                    "i7-1365URE",
                    "i7-1366URE",
                    "i7-13700",
                    "i7-13700E",
                    "i7-13700F",
                    "i7-13700H",
                    "i7-13700HX",
                    "i7-13700K",
                    "i7-13700KF",
                    "i7-13700T",
                    "i7-13700TE",
                    "i7-13705H",
                    "i7-1370P",
                    "i7-1370PE",
                    "i7-1370PRE",
                    "i7-1375PRE",
                    "i7-13800H",
                    "i7-13800HE",
                    "i7-13800HRE",
                    "i7-13850HX",
                    "i7-8086K",
                    "i7-8500Y",
                    "i7-8550U",
                    "i7-8557U",
                    "i7-8559U",
                    "i7-8565U",
                    "i7-8569U",
                    "i7-8650U",
                    "i7-8665U",
                    "i7-8665UE",
                    "i7-8700",
                    "i7-8700B",
                    "i7-8700K",
                    "i7-8700T",
                    "i7-8750H",
                    "i7-8850H",
                    "i7-9700",
                    "i7-9700E",
                    "i7-9700F",
                    "i7-9700K",
                    "i7-9700KF",
                    "i7-9700T",
                    "i7-9700TE",
                    "i7-9750H",
                    "i7-9750HF",
                    "i7-9850H",
                    "i7-9850HE",
                    "i7-9850HL",
                    "i9-14900",
                    "i9-14900F",
                    "i9-14900HX",
                    "i9-14900K",
                    "i9-14900KF",
                    "i9-14900T",
                    "i9-10850K",
                    "i9-10885H",
                    "i9-10900",
                    "i9-10900E",
                    "i9-10900F",
                    "i9-10900K",
                    "i9-10900KF",
                    "i9-10900T",
                    "i9-10900TE",
                    "i9-10980HK",
                    "i9-11900",
                    "i9-11900F",
                    "i9-11900H",
                    "i9-11900K",
                    "i9-11900KF",
                    "i9-11900T",
                    "i9-11950H",
                    "i9-11980HK",
                    "i9-12900",
                    "i9-12900E",
                    "i9-12900F",
                    "i9-12900H",
                    "i9-12900HK",
                    "i9-12900HX",
                    "i9-12900K",
                    "i9-12900KF",
                    "i9-12900KS",
                    "i9-12900T",
                    "i9-12900TE",
                    "i9-12950HX",
                    "i9-13900",
                    "i9-13900E",
                    "i9-13900F",
                    "i9-13900H",
                    "i9-13900HK",
                    "i9-13900HX",
                    "i9-13900K",
                    "i9-13900KF",
                    "i9-13900KS",
                    "i9-13900T",
                    "i9-13900TE",
                    "i9-13905H",
                    "i9-13950HX",
                    "i9-13980HX",
                    "i9-8950HK",
                    "i9-9880H",
                    "i9-9900",
                    "i9-9900K",
                    "i9-9900KF",
                    "i9-9900KS",
                    "i9-9900T",
                    "i9-9980HK",
                    "m3-8100Y",
                    "300",
                    "310",
                    "310T",
                    "U300",
                    "U300E",
                    "U300RE",
                    "300T",
                    "N100",
                    "N150",
                    "N200",
                    "N250",
                    "N50",
                    "N97",
                    "U301L",
                    "U302L",
                    "U303L"
                ]
            },
            { 
                "Intel Core Ultra", [
                    "3 105UL",
                    "3 205T",
                    "5 125H",
                    "5 125U",
                    "5 125UL",
                    "5 134U",
                    "5 135H",
                    "5 135HL",
                    "5 135U",
                    "5 135UL",
                    "5 205",
                    "5 225",
                    "5 225F",
                    "5 225H",
                    "5 225T",
                    "5 225U",
                    "5 226V",
                    "5 228V",
                    "5 230F",
                    "5 235",
                    "5 235H",
                    "5 235HX",
                    "5 235T",
                    "5 235U",
                    "5 236V",
                    "5 238V",
                    "5 245",
                    "5 245HX",
                    "5 245K",
                    "5 245KF",
                    "5 245T",
                    "7 155H",
                    "7 155HL",
                    "7 155U",
                    "7 155UL",
                    "7 164U",
                    "7 165H",
                    "7 165HL",
                    "7 165U",
                    "7 255H",
                    "7 255HX",
                    "7 255U",
                    "7 256V",
                    "7 258V",
                    "7 265",
                    "7 265F",
                    "7 265H",
                    "7 265HX",
                    "7 265K",
                    "7 265KF",
                    "7 265T",
                    "7 265U",
                    "7 266V",
                    "7 268V",
                    "9 185H",
                    "9 275HX",
                    "9 285",
                    "9 285H",
                    "9 285HX",
                    "9 285K",
                    "9 285T",
                    "9 288V"
                ]
            },
            {
                "Intel Xeon", [
                    "D-1702",
                    "D-1712TR",
                    "D-1713NT",
                    "D-1713NTE",
                    "D-1714",
                    "D-1715TER",
                    "D-1718T",
                    "D-1722NE",
                    "D-1726",
                    "D-1731NTE",
                    "D-1732TE",
                    "D-1733NT",
                    "D-1734NT",
                    "D-1735TR",
                    "D-1736",
                    "D-1736NT",
                    "D-1739",
                    "D-1746TER",
                    "D-1747NTE",
                    "D-1748TE",
                    "D-1749NT",
                    "D-1813NT",
                    "D-1823NT",
                    "D-1834",
                    "D-1844NT",
                    "D-1846",
                    "D-1848TER",
                    "D-2712T",
                    "D-2733NT",
                    "D-2738",
                    "D-2739NT",
                    "D-2745NX",
                    "D-2752NTE",
                    "D-2752TER",
                    "D-2753NT",
                    "D-2757NX",
                    "D-2766NT",
                    "D-2775TE",
                    "D-2776NT",
                    "D-2777NX",
                    "D-2779",
                    "D-2786NTE",
                    "D-2795NT",
                    "D-2796NT",
                    "D-2796TE",
                    "D-2798NT",
                    "D-2798NX",
                    "D-2799",
                    "D-2832NT",
                    "D-2843NT",
                    "D-2876NT",
                    "D-2896NT",
                    "D-2896TER",
                    "D-2899NT",
                    "Gold 5315Y",
                    "Gold 5317",
                    "Gold 5318N",
                    "Gold 5318S",
                    "Gold 5318Y",
                    "Gold 5320",
                    "Gold 5320T",
                    "Gold 6312U",
                    "Gold 6314U",
                    "Gold 6326",
                    "Gold 6330",
                    "Gold 6330N",
                    "Gold 6334",
                    "Gold 6336Y",
                    "Gold 6338",
                    "Gold 6338N",
                    "Gold 6338T",
                    "Gold 6342",
                    "Gold 6346",
                    "Gold 6348",
                    "Gold 6354",
                    "Platinum 8351N",
                    "Platinum 8352M",
                    "Platinum 8352S",
                    "Platinum 8352V",
                    "Platinum 8352Y",
                    "Platinum 8358",
                    "Platinum 8358P",
                    "Platinum 8360Y",
                    "Platinum 8362",
                    "Platinum 8368",
                    "Platinum 8368Q",
                    "Platinum 8380",
                    "Silver 4309Y",
                    "Silver 4310",
                    "Silver 4310T",
                    "Silver 4314",
                    "Silver 4316",
                    "W-2102",
                    "W-3323",
                    "W-3335",
                    "W-3345",
                    "W-3365",
                    "W-3375",
                    "E-2124",
                    "E-2124G",
                    "E-2126G",
                    "E-2134",
                    "E-2136",
                    "E-2144G",
                    "E-2146G",
                    "E-2174G",
                    "E-2176G",
                    "E-2176M",
                    "E-2186G",
                    "E-2186M",
                    "E-2224",
                    "E-2224G",
                    "E-2226G",
                    "E-2226GE",
                    "E-2234",
                    "E-2236",
                    "E-2244G",
                    "E-2246G",
                    "E-2254ME",
                    "E-2254ML",
                    "E-2274G",
                    "E-2276G",
                    "E-2276M",
                    "E-2276ME",
                    "E-2276ML",
                    "E-2278G",
                    "E-2278GE",
                    "E-2278GEL",
                    "E-2286G",
                    "E-2286M",
                    "E-2288G",
                    "E-2314",
                    "E-2324G",
                    "E-2334",
                    "E-2336",
                    "E-2356G",
                    "E-2374G",
                    "E-2378",
                    "E-2378G",
                    "E-2386G",
                    "E-2388G",
                    "E-2414",
                    "E-2434",
                    "E-2436",
                    "E-2456",
                    "E-2468",
                    "E-2478",
                    "E-2486",
                    "E-2488",
                    "Gold 6405U",
                    "Gold G6400",
                    "Gold G6400E",
                    "Gold G6400T",
                    "Gold G6400TE",
                    "Gold G6405",
                    "Gold G6405T",
                    "Gold G6500",
                    "Gold G6500T",
                    "Gold G6505",
                    "Gold G6505T",
                    "Gold G6600",
                    "Gold G6605",
                    "W-10855M",
                    "W-10885M",
                    "W-11155MLE",
                    "W-11155MRE",
                    "W-11555MLE",
                    "W-11555MRE",
                    "W-11855M",
                    "W-11865MLE",
                    "W-11865MRE",
                    "W-11955M",
                    "W-1250",
                    "W-1250E",
                    "W-1250P",
                    "W-1250TE",
                    "W-1270",
                    "W-1270E",
                    "W-1270P",
                    "W-1270TE",
                    "W-1290",
                    "W-1290E",
                    "W-1290P",
                    "W-1290T",
                    "W-1290TE",
                    "W-1350",
                    "W-1350P",
                    "W-1370",
                    "W-1370P",
                    "W-1390",
                    "W-1390P",
                    "W-1390T",
                    "W9-3475X"
                ]
            },
            {
                "Intel Celeron", [
                    "5805",
                    "6305",
                    "7300",
                    "7305",
                    "5205U",
                    "5305U",
                    "G5900",
                    "G5900E",
                    "G5900T",
                    "G5900TE",
                    "G5905",
                    "G5905T",
                    "G5920",
                    "G5925",
                    "3867U",
                    "4205U",
                    "4305U",
                    "4305UE",
                    "6305E",
                    "6600HE",
                    "7305E",
                    "7305L",
                    "G4900 ",
                    "G4900T",
                    "G4920",
                    "G4930",
                    "G4930E",
                    "G4930T",
                    "G4932E",
                    "G4950",
                    "G6900",
                    "G6900E",
                    "G6900T",
                    "G6900TE",
                    "J4025",
                    "J4125",
                    "N4020",
                    "N4120",
                    "N4500",
                    "N4505",
                    "N5100",
                    "N5105"
                ]
            },
            {
                "Intel Pentium", [
                    "6805",
                    "Gold 8500",
                    "Gold 8505",
                    "Gold 4417U",
                    "Gold 4425Y",
                    "Gold 5400T",
                    "Gold 5405U",
                    "Gold 6500Y",
                    "Gold 7505",
                    "Gold G5400",
                    "Gold G5420",
                    "Gold G5420T",
                    "Gold G5500",
                    "Gold G5500T",
                    "Gold G5600",
                    "Gold G5600T",
                    "Gold G5620",
                    "Gold G7400",
                    "Gold G7400E",
                    "Gold G7400T",
                    "Gold G7400TE",
                    "J5040",
                    "N5030",
                    "Silver N6000",
                    "Silver N6005"
                ]
            },
            {
                "Intel Atom", [
                    "x7211E",
                    "x7213E",
                    "x7425E"
                ]
            },
        
            // AMD-CPUs
            {
                "AMD Ryzen", [
                    "3015e",
                    "3020e",
                    "3200G",
                    "3200GE",
                    "3300U",
                    "4350G",
                    "4350GE",
                    "4355G",
                    "4355GE",
                    "4450U",
                    "5350G",
                    "5350GE",
                    "5450U",
                    "5475U",
                    "7330U",
                    "8300G",
                    "8300GE",
                    "2300X",
                    "3100",
                    "3200G",
                    "3200GE",
                    "3200U",
                    "3250C",
                    "3250U",
                    "3300U",
                    "3350U",
                    "4100",
                    "4300G",
                    "4300GE",
                    "4300U",
                    "5125C",
                    "5300G",
                    "5300GE",
                    "5300U",
                    "5380U",
                    "5400U",
                    "5425C",
                    "5425U",
                    "7320e",
                    "7320U",
                    "7330U",
                    "7335U",
                    "7440U",
                    "8300G",
                    "2600",
                    "3350G",
                    "3350GE",
                    "3400G",
                    "3400GE",
                    "3500U",
                    "3600",
                    "4650G",
                    "4650GE",
                    "4650U",
                    "4655G",
                    "4655GE",
                    "5475U",
                    "5645",
                    "5650G",
                    "5650GE",
                    "5650HS",
                    "5650HX",
                    "5650U",
                    "5675U",
                    "5750G",
                    "5750GE",
                    "6650H",
                    "6650HS",
                    "6650U",
                    "7530U",
                    "7535U",
                    "7540U",
                    "7640U",
                    "8500G",
                    "8500GE",
                    "8540U",
                    "8600G",
                    "8600GE",
                    "8640HS",
                    "8640U",
                    "8645HS",
                    "2500X",
                    "2600",
                    "2600E",
                    "2600X",
                    "3350G",
                    "3350GE",
                    "3400G",
                    "3400GE",
                    "3450U",
                    "3500",
                    "3500C",
                    "3500U",
                    "3500X",
                    "3550H",
                    "3580U",
                    "3600",
                    "3600X",
                    "3600XT",
                    "4500",
                    "4500U",
                    "4600G",
                    "4600GE",
                    "4600H",
                    "4600HS",
                    "4600U",
                    "5300G",
                    "5300GE",
                    "5425U",
                    "5500",
                    "5500U",
                    "5560U",
                    "5600",
                    "5600G",
                    "5600GE",
                    "5600H",
                    "5600HS",
                    "5600U",
                    "5600X",
                    "5625C",
                    "5625U",
                    "6600H",
                    "6600HS",
                    "6600U",
                    "7430U",
                    "7520U",
                    "7530U",
                    "7535HS",
                    "7535U",
                    "7540U",
                    "7600",
                    "7600X",
                    "7640H",
                    "7640HS",
                    "7640S",
                    "7640U",
                    "7645HX",
                    "8500G",
                    "8600G",
                    "2700",
                    "2700X",
                    "3700",
                    "3700U",
                    "4750G",
                    "4750GE",
                    "4750U",
                    "5845",
                    "5850HS",
                    "5850HX",
                    "5850U",
                    "5875U",
                    "6850H",
                    "6850HS",
                    "6850U",
                    "6860Z",
                    "7730U",
                    "7840HS",
                    "7840U",
                    "8700G",
                    "8840HS",
                    "8840U",
                    "8845HS",
                    "8945HS",
                    "2700",
                    "2700E",
                    "2700X",
                    "3700C",
                    "3700U",
                    "3700X",
                    "3750H",
                    "3780U",
                    "3800X",
                    "3800XT",
                    "4700G",
                    "4700GE",
                    "4700U",
                    "4800H",
                    "4800HS",
                    "4800U",
                    "5700G",
                    "5700GE",
                    "5700U",
                    "5700X",
                    "5800",
                    "5800",
                    "5800H",
                    "5800HS",
                    "5800U",
                    "5800X",
                    "5800X3D",
                    "5825C",
                    "5825U",
                    "6800H",
                    "6800HS",
                    "6800U",
                    "6810U",
                    "7700",
                    "7700X",
                    "7730U",
                    "7735HS",
                    "7735U",
                    "7736U",
                    "7745HX",
                    "7800X3D",
                    "7840H",
                    "7840HS",
                    "7840S",
                    "7840U",
                    "8700G",
                    "3900",
                    "5945",
                    "6950H",
                    "6950HS",
                    "3900",
                    "3900X",
                    "3900XT",
                    "3950X",
                    "4900H",
                    "4900HS",
                    "5900",
                    "5900HS",
                    "5900HX",
                    "5900X",
                    "5950X",
                    "5980HS",
                    "5980HX",
                    "6900HS",
                    "6900HX",
                    "6980HS",
                    "6980HX",
                    "7845HX",
                    "7900",
                    "7900X",
                    "7900X3D",
                    "7940H",
                    "7940HS",
                    "7945HX",
                    "7950X",
                    "7950X3D",
                    "9800X3D",
                    "Z1"
                ]
            },
            {
                "AMD Ryzen Threadripper", [
                    "3945WX",
                    "3955WX",
                    "3975WX",
                    "3995WX",
                    "5945WX",
                    "5955WX",
                    "5965WX",
                    "5975WX",
                    "5995WX"
                ]
            },
            {
                "AMD Ryzen Embedded", [
                    "R2312",
                    "R2314",
                    "R2514",
                    "R2544",
                    "V2516",
                    "V2546",
                    "V2718",
                    "V2748"
                ]
            },
            {
                "AMD Athlon", [
                    "3000G",
                    "300GE",
                    "300U",
                    "320GE",
                    "7120e",
                    "7120U",
                    "7220e",
                    "7220U",
                    "Gold 3150C",
                    "Gold 3150G",
                    "Gold 3150GE",
                    "Gold 3150U",
                    "Gold PRO 3125GE",
                    "Gold PRO 3150G",
                    "Gold PRO 3150GE",
                    "Gold PRO 4150GE",
                    "PRO 300GE",
                    "PRO 300U",
                    "PRO 3045B",
                    "Silver 3050C",
                    "Silver 3050e",
                    "Silver 3050GE",
                    "Silver 3050U"
                ]
            },
            {
                "AMD EPYC", [
                    "7232P",
                    "7252",
                    "7262",
                    "7272",
                    "7282",
                    "72F3",
                    "7302",
                    "7302P",
                    "7313",
                    "7313P",
                    "7343",
                    "7352",
                    "73F3",
                    "7402",
                    "7402P",
                    "7413",
                    "7443",
                    "7443P",
                    "7452",
                    "7453",
                    "74F3",
                    "7502",
                    "7502P",
                    "7513",
                    "7532",
                    "7542",
                    "7543",
                    "7543P",
                    "7552",
                    "75F3",
                    "7642",
                    "7643",
                    "7662",
                    "7663",
                    "7702",
                    "7702P",
                    "7713",
                    "7713P",
                    "7742",
                    "7763",
                    "7F32",
                    "7F52",
                    "7F72",
                    "7H12",
                    "8024P",
                    "8024PN",
                    "8124P",
                    "8124PN",
                    "8224P",
                    "8224PN",
                    "8324P",
                    "8324PN",
                    "8434P",
                    "8434PN",
                    "8534P",
                    "8534PN",
                    "9015",
                    "9115",
                    "9124",
                    "9135",
                    "9174F",
                    "9175F",
                    "9184X",
                    "9224",
                    "9254",
                    "9255",
                    "9274F",
                    "9275F",
                    "9334",
                    "9335",
                    "9354",
                    "9354P",
                    "9355",
                    "9355P",
                    "9365",
                    "9374F",
                    "9375F",
                    "9384X",
                    "9454",
                    "9454P",
                    "9455",
                    "9455P",
                    "9474F",
                    "9534",
                    "9554",
                    "9554P",
                    "9565",
                    "9575F",
                    "9634",
                    "9645",
                    "9654",
                    "9654P",
                    "9655",
                    "9655P",
                    "9684X",
                    "9734",
                    "9745",
                    "9754",
                    "9754S",
                    "9755",
                    "9825",
                    "9845",
                    "9965"
                ]
            }
        };

        private static string? GetFullCpuName()
        {
            try
            {
                var searcher = new ManagementObjectSearcher("SELECT * FROM Win32_Processor");
                foreach (var o in searcher.Get())
                {
                    var obj = (ManagementObject)o;
                    return obj["Name"].ToString();
                }
            }
            catch (Exception ex)
            {
                Debug.WriteLine($"Failed to get CPU name: {ex.Message}", ConsoleColor.Red);
                Logging.Log($"Failed to get CPU name:\n{ex}", Logging.LogLevel.ERROR);
            }
            return string.Empty;
        }

        public static bool IsCpuCompatible()
        {
            var fullCpuName = GetFullCpuName();
            Debug.WriteLine("Got CPU: " + fullCpuName, ConsoleColor.Yellow);
            Logging.Log("Got CPU: " + fullCpuName, Logging.LogLevel.ERROR);
            
            if (string.IsNullOrEmpty(fullCpuName))
            {
                return false;
            }

            foreach (var entry in CompatibleCpus)
            {
                var manufacturerAndSeries = entry.Key;
                var compatibleModels = entry.Value;

                if (!fullCpuName.Contains(manufacturerAndSeries, StringComparison.OrdinalIgnoreCase)) continue;
                if (compatibleModels.Any(model => fullCpuName.Contains(model, StringComparison.OrdinalIgnoreCase)))
                {
                    return true;
                }
            }

            return false;
        }

    }
}
